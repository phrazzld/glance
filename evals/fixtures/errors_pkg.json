{
  "directory": "glance/errors",
  "files": {
    "errors.go": "// Package errors provides custom error types and error handling utilities\n// for the glance application.\npackage errors\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n\t\"os\"\n)\n\n// -----------------------------------------------------------------------------\n// Error Severity Levels\n// -----------------------------------------------------------------------------\n\n// ErrorSeverity represents the severity level of an error.\ntype ErrorSeverity int\n\nconst (\n\t// ErrorSeverityNormal indicates a standard error.\n\tErrorSeverityNormal ErrorSeverity = iota\n\n\t// ErrorSeverityWarning indicates a warning condition.\n\tErrorSeverityWarning\n\n\t// ErrorSeverityCritical indicates a critical error.\n\tErrorSeverityCritical\n)\n\n// String returns a string representation of the severity level.\nfunc (s ErrorSeverity) String() string {\n\tswitch s {\n\tcase ErrorSeverityNormal:\n\t\treturn \"ERROR\"\n\tcase ErrorSeverityWarning:\n\t\treturn \"WARNING\"\n\tcase ErrorSeverityCritical:\n\t\treturn \"CRITICAL\"\n\tdefault:\n\t\treturn \"UNKNOWN\"\n\t}\n}\n\n// -----------------------------------------------------------------------------\n// Error Types\n// -----------------------------------------------------------------------------\n\n// GlanceError is the base interface for all custom error types in the application.\ntype GlanceError interface {\n\terror\n\n\t// Type returns the error type identifier\n\tType() string\n\n\t// Code returns the error code\n\tCode() string\n\n\t// Severity returns the error severity level\n\tSeverity() ErrorSeverity\n\n\t// Suggestion returns a recommended action to resolve the error\n\tSuggestion() string\n\n\t// Unwrap returns the wrapped error if any\n\tUnwrap() error\n\n\t// WithCode sets the error code and returns the error\n\tWithCode(code string) GlanceError\n\n\t// WithSeverity sets the error severity and returns the error\n\tWithSeverity(severity ErrorSeverity) GlanceError\n\n\t// WithSuggestion sets a suggestion for resolving the error and returns the error\n\tWithSuggestion(suggestion string) GlanceError\n\n\t// WithCause sets the underlying cause of an error and returns the error\n\tWithCause(cause error) GlanceError\n}\n\n// baseError is the common implementation of the GlanceError interface.\ntype baseError struct {\n\terrorType  string\n\tmessage    string\n\tcode       string\n\tseverity   ErrorSeverity\n\tsuggestion string\n\tcause      error\n}\n\n// Error returns the error message.\nfunc (e *baseError) Error() string {\n\tvar result string\n\n\t// Include code if present\n\tif e.code != \"\" {\n\t\tresult = fmt.Sprintf(\"[%s] \", e.code)\n\t}\n\n\t// Add the main message\n\tresult += e.message\n\n\t// Add severity if not normal\n\tif e.severity != ErrorSeverityNormal {\n\t\tresult += fmt.Sprintf(\" (%s)\", e.severity)\n\t}\n\n\t// Add suggestion if present\n\tif e.suggestion != \"\" {\n\t\tresult += fmt.Sprintf(\" - Suggestion: %s\", e.suggestion)\n\t}\n\n\t// Add wrapped error if present\n\tif e.cause != nil {\n\t\tresult += fmt.Sprintf(\": %v\", e.cause)\n\t}\n\n\treturn result\n}\n\n// Type returns the error type.\nfunc (e *baseError) Type() string {\n\treturn e.errorType\n}\n\n// Code returns the error code.\nfunc (e *baseError) Code() string {\n\treturn e.code\n}\n\n// Severity returns the error severity level.\nfunc (e *baseError) Severity() ErrorSeverity {\n\treturn e.severity\n}\n\n// Suggestion returns the recommended action to resolve the error.\nfunc (e *baseError) Suggestion() string {\n\treturn e.suggestion\n}\n\n// Unwrap returns the wrapped error.\nfunc (e *baseError) Unwrap() error {\n\treturn e.cause\n}\n\n// WithCode sets the error code.\nfunc (e *baseError) WithCode(code string) GlanceError {\n\te.code = code\n\treturn e\n}\n\n// WithSeverity sets the error severity level.\nfunc (e *baseError) WithSeverity(severity ErrorSeverity) GlanceError {\n\te.severity = severity\n\treturn e\n}\n\n// WithSuggestion sets a suggestion for resolving the error.\nfunc (e *baseError) WithSuggestion(suggestion string) GlanceError {\n\te.suggestion = suggestion\n\treturn e\n}\n\n// -----------------------------------------------------------------------------\n// Specific Error Types\n// -----------------------------------------------------------------------------\n\n// FileSystemError represents an error related to file system operations.\ntype FileSystemError struct {\n\tbaseError\n}\n\n// APIError represents an error related to LLM API operations.\ntype APIError struct {\n\tbaseError\n}\n\n// ConfigError represents an error related to configuration.\ntype ConfigError struct {\n\tbaseError\n}\n\n// ValidationError represents an error related to input validation.\ntype ValidationError struct {\n\tbaseError\n}\n\n// -----------------------------------------------------------------------------\n// Error Creation Functions\n// -----------------------------------------------------------------------------\n\n// New creates a new base error.\nfunc New(message string) GlanceError {\n\treturn &baseError{\n\t\terrorType: \"General\",\n\t\tmessage:   message,\n\t\tseverity:  ErrorSeverityNormal,\n\t}\n}\n\n// Wrap wraps an existing error with additional context.\nfunc Wrap(err error, message string) GlanceError {\n\treturn &baseError{\n\t\terrorType: \"General\",\n\t\tmessage:   message,\n\t\tseverity:  ErrorSeverityNormal,\n\t\tcause:     err,\n\t}\n}\n\n// NewFileSystemError creates a new file system error.\nfunc NewFileSystemError(message string, cause error) GlanceError {\n\treturn &FileSystemError{\n\t\tbaseError: baseError{\n\t\t\terrorType: \"FileSystem\",\n\t\t\tmessage:   message,\n\t\t\tseverity:  ErrorSeverityNormal,\n\t\t\tcause:     cause,\n\t\t},\n\t}\n}\n\n// NewAPIError creates a new API error.\nfunc NewAPIError(message string, cause error) GlanceError {\n\treturn &APIError{\n\t\tbaseError: baseError{\n\t\t\terrorType: \"API\",\n\t\t\tmessage:   message,\n\t\t\tseverity:  ErrorSeverityNormal,\n\t\t\tcause:     cause,\n\t\t},\n\t}\n}\n\n// NewConfigError creates a new configuration error.\nfunc NewConfigError(message string, cause error) GlanceError {\n\treturn &ConfigError{\n\t\tbaseError: baseError{\n\t\t\terrorType: \"Config\",\n\t\t\tmessage:   message,\n\t\t\tseverity:  ErrorSeverityNormal,\n\t\t\tcause:     cause,\n\t\t},\n\t}\n}\n\n// NewValidationError creates a new validation error.\nfunc NewValidationError(message string, cause error) GlanceError {\n\treturn &ValidationError{\n\t\tbaseError: baseError{\n\t\t\terrorType: \"Validation\",\n\t\t\tmessage:   message,\n\t\t\tseverity:  ErrorSeverityNormal,\n\t\t\tcause:     cause,\n\t\t},\n\t}\n}\n\n// -----------------------------------------------------------------------------\n// Error Wrapping Helper Functions\n// -----------------------------------------------------------------------------\n\n// WrapFileError wraps a file system related error with additional context.\n// Use this for errors from os, io, filepath, etc.\nfunc WrapFileError(err error, message string) GlanceError {\n\tif err == nil {\n\t\treturn nil\n\t}\n\n\t// If it's already a FileSystemError, maintain the type but update the message\n\tvar fsErr *FileSystemError\n\tif errors.As(err, &fsErr) {\n\t\treturn NewFileSystemError(message, err)\n\t}\n\n\t// Map common os errors to specific sentinel errors\n\tif errors.Is(err, os.ErrNotExist) {\n\t\treturn &FileSystemError{\n\t\t\tbaseError: baseError{\n\t\t\t\terrorType:  \"FileSystem\",\n\t\t\t\tmessage:    message,\n\t\t\t\tcode:       ErrFileNotFound.Code(),\n\t\t\t\tseverity:   ErrorSeverityNormal,\n\t\t\t\tcause:      err,\n\t\t\t\tsuggestion: ErrFileNotFound.Suggestion(),\n\t\t\t},\n\t\t}\n\t} else if errors.Is(err, os.ErrPermission) {\n\t\treturn &FileSystemError{\n\t\t\tbaseError: baseError{\n\t\t\t\terrorType:  \"FileSystem\",\n\t\t\t\tmessage:    message,\n\t\t\t\tcode:       ErrFilePermission.Code(),\n\t\t\t\tseverity:   ErrorSeverityNormal,\n\t\t\t\tcause:      err,\n\t\t\t\tsuggestion: ErrFilePermission.Suggestion(),\n\t\t\t},\n\t\t}\n\t}\n\n\t// Default case\n\treturn NewFileSystemError(message, err)\n}\n\n// WrapAPIError wraps an API related error with additional context.\n// Use this for errors from API clients, HTTP requests, etc.\nfunc WrapAPIError(err error, message string) GlanceError {\n\tif err == nil {\n\t\treturn nil\n\t}\n\n\t// If it's already an APIError, maintain the type but update the message\n\tvar apiErr *APIError\n\tif errors.As(err, &apiErr) {\n\t\treturn NewAPIError(message, err)\n\t}\n\n\t// Create a new API error\n\treturn NewAPIError(message, err)\n}\n\n// WrapConfigError wraps a configuration related error with additional context.\n// Use this for errors from flag parsing, config loading, etc.\nfunc WrapConfigError(err error, message string) GlanceError {\n\tif err == nil {\n\t\treturn nil\n\t}\n\n\t// If it's already a ConfigError, maintain the type but update the message\n\tvar cfgErr *ConfigError\n\tif errors.As(err, &cfgErr) {\n\t\treturn NewConfigError(message, err)\n\t}\n\n\t// Create a new config error\n\treturn NewConfigError(message, err)\n}\n\n// WrapValidationError wraps a validation related error with additional context.\n// Use this for errors from input validation.\nfunc WrapValidationError(err error, message string) GlanceError {\n\tif err == nil {\n\t\treturn nil\n\t}\n\n\t// If it's already a ValidationError, maintain the type but update the message\n\tvar valErr *ValidationError\n\tif errors.As(err, &valErr) {\n\t\treturn NewValidationError(message, err)\n\t}\n\n\t// Create a new validation error\n\treturn NewValidationError(message, err)\n}\n\n// WithCause sets the underlying cause of an error.\n// This is useful for maintaining error chains while using sentinel errors.\nfunc (e *baseError) WithCause(cause error) GlanceError {\n\te.cause = cause\n\treturn e\n}\n\n// -----------------------------------------------------------------------------\n// Error Type Checking Functions\n// -----------------------------------------------------------------------------\n\n// IsFileSystemError checks if an error is a FileSystemError.\nfunc IsFileSystemError(err error) bool {\n\tvar e *FileSystemError\n\treturn errors.As(err, &e)\n}\n\n// IsAPIError checks if an error is an APIError.\nfunc IsAPIError(err error) bool {\n\tvar e *APIError\n\treturn errors.As(err, &e)\n}\n\n// IsConfigError checks if an error is a ConfigError.\nfunc IsConfigError(err error) bool {\n\tvar e *ConfigError\n\treturn errors.As(err, &e)\n}\n\n// IsValidationError checks if an error is a ValidationError.\nfunc IsValidationError(err error) bool {\n\tvar e *ValidationError\n\treturn errors.As(err, &e)\n}\n\n// -----------------------------------------------------------------------------\n// Sentinel Errors\n// -----------------------------------------------------------------------------\n\n// Common file system errors\nvar (\n\tErrFileNotFound      = NewFileSystemError(\"file not found\", nil).WithCode(\"FS-001\")\n\tErrFilePermission    = NewFileSystemError(\"permission denied\", nil).WithCode(\"FS-002\")\n\tErrDirectoryNotFound = NewFileSystemError(\"directory not found\", nil).WithCode(\"FS-003\")\n\tErrInvalidPath       = NewFileSystemError(\"invalid path\", nil).WithCode(\"FS-004\")\n\tErrFileAlreadyExists = NewFileSystemError(\"file already exists\", nil).WithCode(\"FS-005\")\n)\n\n// Common API errors\nvar (\n\tErrAPITimeout        = NewAPIError(\"API request timed out\", nil).WithCode(\"API-001\")\n\tErrAPIRateLimit      = NewAPIError(\"API rate limit exceeded\", nil).WithCode(\"API-002\")\n\tErrAPIAuthentication = NewAPIError(\"API authentication failed\", nil).WithCode(\"API-003\")\n\tErrAPIQuota          = NewAPIError(\"API quota exceeded\", nil).WithCode(\"API-004\")\n\tErrAPIResponseFormat = NewAPIError(\"invalid API response format\", nil).WithCode(\"API-005\")\n)\n\n// Common configuration errors\nvar (\n\tErrConfigMissingKey = NewConfigError(\"required configuration key missing\", nil).WithCode(\"CFG-001\")\n\tErrConfigFormat     = NewConfigError(\"invalid configuration format\", nil).WithCode(\"CFG-002\")\n\tErrConfigEnvVar     = NewConfigError(\"environment variable not set\", nil).WithCode(\"CFG-003\")\n\tErrConfigValidation = NewConfigError(\"configuration validation failed\", nil).WithCode(\"CFG-004\")\n)\n\n// Common validation errors\nvar (\n\tErrValidationRequired = NewValidationError(\"required field missing\", nil).WithCode(\"VAL-001\")\n\tErrValidationFormat   = NewValidationError(\"invalid format\", nil).WithCode(\"VAL-002\")\n\tErrValidationRange    = NewValidationError(\"value out of range\", nil).WithCode(\"VAL-003\")\n)\n"
  },
  "subGlances": []
}
